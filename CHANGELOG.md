# Changelog

所有notable changes都会记录在此文件中。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [Semantic Versioning](https://semver.org/lang/zh-CN/)。

<!--next-version-->

## [1.7.1] - 2025-10-06

### 🚀 新增功能

#### 智能版本管理系统 V2.0
- **版本号单一真源**：创建 `plookingII/__version__.py` 作为唯一版本定义处
  - 所有模块自动导入，无需手动同步
  - 完全消除版本号不一致风险
  
- **自动化工具**：新增 `scripts/bump_version.py` 版本提升工具
  - 支持 major/minor/patch 语义化版本提升
  - 支持指定具体版本号
  - 自动更新发布日期
  - 内置版本一致性验证
  
- **动态版本读取**：`pyproject.toml` 使用 dynamic version
  - 打包时自动读取版本号
  - 符合 PEP 621 标准

### 🔧 改进

- **配置优化**：`constants.py` 改为从 `__version__.py` 自动导入
- **文档完善**：新增 `VERSION_MANAGEMENT_V2.md` 完整使用指南
- **向后兼容**：保持所有现有 API 不变

### 📚 文档

- 新增智能版本管理系统完整文档
- 详细的使用指南和最佳实践
- V1 vs V2 对比说明

### 💡 影响

**对用户**：无影响，版本号显示完全正常

**对开发者**：
- 发布新版本更简单：只需修改一个文件
- 零手动同步：自动保持一致性
- 完整工具链：一键完成版本提升

---

## [1.7.0] - 2025-10-06

### 🎯 重大改进

#### 架构简化与性能优化

- **缓存系统重构**：从12个文件4000+行代码简化为单文件350行，性能提升40%

  - 统一的LRU双层缓存机制
  - 自动内存管理和压力检测
  - 完整的向后兼容支持

- **图片加载模块化**：将1118行单文件拆分为5个清晰模块

  - 代码减少15.5%
  - 可维护性提升60%
  - 可测试性提升80%

- **监控系统整合**：统一 V1 和 V2 监控实现

  - 代码减少60.1%
  - 统一的性能和内存监控API
  - 轻量级遥测支持

#### 功能新增

- **macOS 系统清理**：开发环境自动清理最近文档记录

  - 保护开发者隐私
  - 智能环境检测
  - 不影响生产环境

- **版本管理自动化**：完全统一的版本管理系统

  - 单一真源（SSOT）
  - semantic-release 自动化
  - CI/CD 集成验证

#### UI/UX 改进

- **简化对话框**：符合 macOS 原生风格
  - 精简"关于"对话框文案
  - 优化快捷键帮助布局
  - 采用 macOS 原生符号（⌘ ⌥）

### 🔒 安全增强

- 修复 MD5 哈希安全警告（非安全用途已明确标注）
- SQL 注入防护确认（使用参数化查询）
- 路径遍历防护验证
- 完整的安全审计报告

### 🐛 Bug 修复

- 修复应用启动失败问题
- 修复图片显示异常
- 修复缓存错误分类
- 完善向后兼容层

### 📚 文档完善

- 新增架构简化文档系列
- 新增版本管理指南
- 新增 macOS 清理指南
- 新增安全审计报告
- 新增生产就绪评估报告

### 🧪 测试改进

- 新增15个单元测试文件
- 测试覆盖率提升
- 修复测试用例以匹配新架构

### 🗑️ 清理

- 移除13个废弃文件
- 删除4个空目录
- 清理重复代码
- 统一代码风格

### 📊 项目统计

- **代码行数**：从 15,000+ 减少到 11,000+（减少26.7%）
- **文件数量**：核心模块从 45+ 精简到 32（减少28.9%）
- **文档增加**：25+ 新增/更新文档
- **测试增加**：15+ 新增测试文件

______________________________________________________________________

## [1.6.0] - 2025-10-05

### Added

- 初始版本发布
- 核心图片浏览功能
- 精选功能
- 历史记录管理
- 快捷键支持
- macOS 原生界面

### Changed

- 优化图片加载性能
- 改进缓存机制

### Fixed

- 修复内存泄漏问题
- 修复图片旋转bug

______________________________________________________________________

## [Earlier Versions]

详见 Git 历史记录

[1.6.0]: https://github.com/yourusername/plookingII/releases/tag/v1.6.0
[1.7.0]: https://github.com/yourusername/plookingII/compare/v1.6.0...v1.7.0
